# Описание
Задача: предсказание расходов за отказ от покупки товара (`item_losses`) на основе данных интернет-магазина.  

Данные:  
- `df_train.csv` — обучающая выборка  
- `df_test.csv` — тестовая выборка  

Метрика оценки качества: **RMSE** (Root Mean Squared Error).

---

## Файлы в репозитории
- [`test_task_DS_Tyty_v2.ipynb`](https://github.com/AtaevEN/test_task_Tyty/blob/main/test_task_DS_Tyty_v2.ipynb) — Jupyter Notebook с полным решением  
- [`df_test_with_preds.csv`](https://github.com/AtaevEN/test_task_Tyty/blob/main/df_test_with_preds.csv) — предсказания для тестовой выборки (с колонкой `y_pred`)  
- `README.md` — описание задания, решения и итогов  

---

## Решение

1. **Предобработка данных**  
   - Заполнение и преобразование признаков  
   - Создание категориальных и числовых признаков  
   - Проверка распределения целевой переменной  

2. **Моделирование**  
   - Построена **двухэтапная модель**:
     - Классификатор для предсказания наличия потерь (0/1)  
     - Регрессор для расчёта размера потерь при наличии  
   - Подбор гиперпараметров (`RandomizedSearchCV`)  
   - Использованы модели LightGBM и ансамблевые подходы  

3. **Оптимизация**  
   - Подбор оптимального порога классификации через ROC-кривую  
   - Сравнение метрик Precision, Recall, Confusion Matrix для разных классов  
   - Анализ влияния выбросов и редких значений  

---

## Результат
- Метрика RMSE на валидации: **≈ 41**  
- Для сравнения: 75-й перцентиль потерь в данных — около **100**, то есть ошибка значительно ниже характерного уровня потерь  
- Модель хорошо справляется с предсказанием **нулевых потерь** (Recall для класса 0 ≈ 0.94)  
- Финальные предсказания сохранены в `df_test_with_preds.csv`

---

## Вывод
Модель демонстрирует адекватное качество и готова к применению на тестовой выборке.  
Дальнейшее улучшение возможно через:  
- добавление новых признаков,  
- использование более сложных ансамблей  
